# Trace Ledger v0

Trace Ledger v0 defines the minimal JSON record emitted for every runtime invocation.

## Contract Goals
- Emit one JSON ledger entry per invocation, including failures.
- Include stable identifiers and timing fields for replay/audit.
- Record runtime-supported contract versions used at invocation time.
- Encode invocation outcome as `success` or `failure` with error details for failures.
- Keep ledger emission best-effort so trace I/O failures do not alter invocation outcomes.

## Ledger Shape (v0)
- `schema_version` (string, required): fixed to `0.1.0`.
- `run_id` (string, required): unique invocation id generated by runtime.
  - Runtime must normalize/fallback to a non-empty `run_id` value before emission, even when run-id hooks fail.
- `started_at` (RFC3339 string, required): invocation start timestamp.
- `completed_at` (RFC3339 string, required): invocation completion timestamp.
  - Runtime must fall back to runtime clock timestamps if caller-provided clock hooks fail.
- `contract_versions` (object, required):
  - `semantic_ir` (string, required)
  - `policy_profile` (string, required)
- `outcome` (object, required):
  - Success: `{ "status": "success" }`
  - Failure: `{ "status": "failure", "error": { "name": string, "message": string } }`

## Related Trace Inspection Outputs
- Runtime may emit optional trace-inspection artifacts in parallel with ledger output:
  - machine-readable JSON-lines records (`options.traceInspectionPath`)
  - human-readable text report entries (`options.traceInspectionReportPath`)
- Inspection entries link the runtime invocation across:
  - trace-ledger linkage: `trace_ledger.trace_entry_id`
  - FeedbackTensor linkage: `feedback_tensor.feedback_id` and `feedback_tensor.trace_entry_id`
  - continuation-gate linkage: `continuation_gate.decision` and `continuation_gate.reason_code`
- Inspection entries include decision-rationale details used by reliability review:
  - confidence metadata via `feedback_tensor.confidence` (`score`, `rationale`, `calibration_band`)
  - repair outcomes and timeline via `repair.{decision, reason_code, history[]}`
- Trace-inspection writes are best-effort and must not change runtime invocation outcomes.

## Files
- Schema: `docs/spec/schemas/traceledger-v0.schema.json`
